{{ define "main" }}

<div class="container-fluid mt-3">
    <div class="row">
        <div class="col" id="root"></div>
    </div>

    <!-- Hidden div for no config file message -->
    <div id="no-config" style="display: none;" class="row scilife-subsection">
        <div class="alert text-center" role="alert" style="--bs-alert-bg: #E9F2D1; --bs-alert-color: black; font-size: 1.5rem;">
            <i class="bi bi-exclamation-triangle-fill" aria-hidden="true"></i>
            Error: No JBrowse2 configuration file found. A configuration file is needed to use the genome browser.
            <br>
            <a href="/" class="btn mt-2">Return to the Homepage</a>
        </div>
    </div>
</div>

{{ if hugo.IsDevelopment }}
    <script>
        window.__jbrowseCacheBuster = true
    </script>
{{ end }}

<!-- Check if the config file exists before loading JBrowse2 -->
<script>
    document.addEventListener('DOMContentLoaded', async function() {
        const urlParams = new URLSearchParams(window.location.search);
        const configFile = urlParams.get('config');


        if (!configFile) {
            document.getElementById('no-config').style.display = 'block';
            return;
        }

        try {
            const response = await fetch(configFile);
            if (response.ok) {
                const script = document.createElement('script');
                script.defer = true;
                script.src = '/browser/static/js/main.85262b6a.js';
                document.head.appendChild(script);
            } else {
                document.getElementById('no-config').style.display = 'block';
            }
        } catch (error) {
            document.getElementById('no-config').style.display = 'block';
        }
    });
</script>

{{ end }}
